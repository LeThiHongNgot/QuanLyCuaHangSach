CREATE DATABASE chs
GO
USE chs
GO
CREATE TABLE DANGNHAP(
TENTAIKHOAN INT,
MATKHAU INT
)
CREATE TABLE PHIEUNHAP(
SOPHIEUNHAP INT IDENTITY(0,1) PRIMARY KEY,
MANHANVIEN NVARCHAR(20),
MADOITAC NVARCHAR(20),
NGAYNHAP DATE,
TONGTIEN INT
)
GO
CREATE TABLE CHITIETPHIEUNHAP(
SOPHIEUNHAP INT,
MASACH NVARCHAR(20),
SOLUONG INT,
GIANHAP INT,
CONSTRAINT PN_PR PRIMARY KEY (SOPHIEUNHAP,MASACH)
)
-----
CREATE TABLE KHOSACH
(
MASACH NVARCHAR(20) PRIMARY KEY,
TENSACH NVARCHAR(100),
SOLUONGCON INT,
TENTACGIA NVARCHAR(20),
GIABAN INT,
TENTHELOAI NVARCHAR(20),
TENNHAXUATBAN NVARCHAR(20)
)
CREATE TABLE NHANVIEN
(
MANHANVIEN NVARCHAR(20) PRIMARY KEY,
CCCD NVARCHAR (20),
HOTEN NVARCHAR(20),
GIOITINH NVARCHAR(3),
NGAYSINH DATE,
DIACHI NVARCHAR(200),
DIENTHOAI NVARCHAR(15),
)
GO
CREATE TABLE KHACHHANG
(
MAKHACHHANG NVARCHAR(20) PRIMARY KEY,
TENKHACHHANG NVARCHAR(20),
DIACHI NVARCHAR(200),
DIENTHOAI NVARCHAR (15),
)
GO
CREATE TABLE HOADON(
SOHOADON INT IDENTITY(0,1) PRIMARY KEY,
MAKHACHHANG NVARCHAR(20),
NGAYBAN DATE,
MANHANVIEN NVARCHAR(20),
TONGTIEN INT

)
GO
CREATE TABLE CHITIETHOADON
(
SOHOADON INT ,
MASACH NVARCHAR(20),
SOLUONGBAN INT
CONSTRAINT HD_PR PRIMARY KEY (SOHOADON,MASACH)
)
GO
CREATE TABLE DOITAC
(
MADOITAC NVARCHAR(20) PRIMARY KEY,
TENDOITAC NVARCHAR(20),
DIACHI NVARCHAR(200),
DIENTHOAI NVARCHAR (15),
)

---
GO
ALTER TABLE CHITIETPHIEUNHAP
ADD CONSTRAINT PHIEUNHAPCHITIET_MASACH_FK FOREIGN KEY (MASACH) REFERENCES KHOSACH(MASACH)
---
ALTER TABLE CHITIETPHIEUNHAP
ADD CONSTRAINT PHIEUNHAPCHITIET_SOPN_FK FOREIGN KEY (SOPHIEUNHAP) REFERENCES PHIEUNHAP(SOPHIEUNHAP)
---
---
ALTER TABLE HOADON
ADD CONSTRAINT  HOADON_MANV_FK FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN)
ALTER TABLE HOADON
ADD CONSTRAINT  HOADON_MAKH_FK FOREIGN KEY (MAKHACHHANG) REFERENCES KHACHHANG(MAKHACHHANG)

---
ALTER TABLE CHITIETHOADON
ADD CONSTRAINT  CHITIETHOADON_SOHD_FK FOREIGN KEY (SOHOADON) REFERENCES HOADON(SOHOADON)
ALTER TABLE CHITIETHOADON
ADD CONSTRAINT  CHITIETHOADON_MASACH_FK FOREIGN KEY (MASACH) REFERENCES KHOSACH(MASACH)
GO
ALTER TABLE PHIEUNHAP
ADD CONSTRAINT PHIEUNHAP_MADOITAC_FK FOREIGN KEY (MADOITAC) REFERENCES DOITAC(MADOITAC)
---

INSERT INTO [dbo].[KHOSACH]
           ([MASACH]
           ,[TENSACH]
           ,[SOLUONGCON]
           ,[TENTACGIA]
           ,[GIABAN]
           ,[TENTHELOAI]
           ,[TENNHAXUATBAN])
  
 VALUES
           ('S00001','Your Name',15,'TG001',150000,N'Tình cảm lãng mạn','NXB01'),
           ('S00002',N'Conan-Thám tử lừng danh',10,'TG002',21000,N'Trinh thám','NXB01'),
           
           ('S00003','Tsubasa',15,'TG003',150000,N'Thể thao','NXB01'),
           
           ('S00004',N'Đắc Nhân Tâm',15,'TG004',85000,N'Kỹ năng sống','NXB02'),
		   ('S00005',N'Tôi Thấy Hoa Vàng Trên Cỏ Xanh',10,'TG005',950000,N'Tâm lý xã hội','NXB02'),
           ('S00006',N'Mắc Biếc ',15,'TG005',850000,N'Tình cảm lãng mạn','NXB02'),
           ('S00007',N'Trạng Quỷnh',15,'TG006',15000,N'Cổ tích','NXB03'),
           ('S00008',N'Doraemon',15,'TG007',18000,N'Viễn tưởng','NXB01');


GO

INSERT INTO [dbo].[PHIEUNHAP]
           ([MANHANVIEN],[NGAYNHAP])
     VALUES
          ('NV01','12/22/2021',),
          ('NV02','10/20/2021'),
          ('NV01','10/29/2022'),
          ('NV02','08/17/2021');

GO

INSERT INTO [dbo].[CHITIETPHIEUNHAP]
           ([SOPHIEUNHAP],[MASACH],[SOLUONG],[GIANHAP])
     VALUES
          (1,'S00001',12,100000),
          (2,'S00008',10,120000),
          (2,'S00002',19,90000),
          (1,'S00003',28,70000);
GO

INSERT INTO [dbo].[KHACHHANG]
           ([MAKHACHHANG]
           ,[TENKHACHHANG]
           ,[DIACHI]
           ,[DIENTHOAI])
     VALUES
           ('HK001',N'Nguyễn Văn A',N'280 An Dương Vương, Quận 5','0909123456'),
		   ('HK002',N'Nguyễn Văn B',N'281 An Dương Vương, Quận 5','0909123457'),
           ('HK003',N'Nguyễn Văn C',N'282 An Dương Vương, Quận 5','0909123458'),
		   ('HK004',N'Nguyễn Văn D',N'283 An Dương Vương, Quận 5','0909123459');

INSERT INTO [dbo].[DOITAC]
           ([MADOITAC]
           ,[TENDOITAC]
           ,[DIACHI]
           ,[DIENTHOAI])
     VALUES
           ('DT001',N'Nguyễn Văn A',N'280 An Dương Vương, Quận 5','0909123456'),
		   ('DT002',N'Nguyễn Văn B',N'281 An Dương Vương, Quận 5','0909123457'),
           ('DT003',N'Nguyễn Văn C',N'282 An Dương Vương, Quận 5','0909123458'),
		   ('DT004',N'Nguyễn Văn D',N'283 An Dương Vương, Quận 5','0909123459');

INSERT INTO [dbo].[NHANVIEN]
           ([MANHANVIEN]
           ,[HOTEN]
           ,[GIOITINH]
           ,[NGAYSINH]
           ,[DIACHI]
           ,[DIENTHOAI])
     VALUES
           ('NV01',N'Trần Văn A','Nam','02/12/1993',N'123 Nguyễn Thị Thập, Quận 7','0123144522'),
           ('NV02',N'Trần Văn B','Nam','07/18/1997',N'13 Nguyễn Du, Quận 1','0123144112'),
           ('NV03',N'Nguyễn Ngọc E',N'Nữ','12/20/1998',N'23 Nguyễn Đình Chiểu, Quận 3','0553144522'),
           ('NV04',N'Trần Thị M',N'Nữ','04/15/1983',N'102 Nguyễn Chí Thanh, Quận 10','0123554522');
GO



INSERT INTO [dbo].[HOADON]
           (
           [MAKHACHHANG]
           ,[NGAYBAN]
           ,[MANHANVIEN]
           ,[TONGTIEN])
     VALUES
           ('HK001','11/21/2022','NV01',150000),
           ('HK002','11/27/2022','NV02',1920000),
           ('HK003','11/03/2022','NV01',54000),
		   ('HK004','11/11/2022','NV01',150000);

GO


INSERT INTO [dbo].[CHITIETHOADON]
           ([SOHOADON],[MASACH]
           ,[SOLUONGBAN])
     VALUES
           (1,'S00001',1),
           (1,'S00001',1),
           (2,'S00002',2),
           (3,'S00008',3),
           (2,'S00003',1);

